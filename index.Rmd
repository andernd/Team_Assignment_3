<br>
<center><img src="http://i.imgur.com/sSaOozN.png" width="500"></center>
 
# Course: Visual Analytics for Policy and Management
 
## Assignment 3: Multivariate plot
 
_____
<a id='part1'></a>
 
### By Nathan Anderson-Hobbs, Johnson Nguyen, Kim Pearson & Marcela VÃ¡zquez
###
 
_____

```{r message= FALSE, warning = FALSE}
# loading the data source and opening libraries
link='https://github.com/marcevl/Team-Assignments/raw/master/Internet2.RData'
load(file=url(link))
library(ggplot2)
str(Internet2)
```

```{r message= FALSE, warning = FALSE}
library(dotwhisker)
library(broom)
library(dplyr)

# creating first model of regression for Download and Upload Speeds on Satisfaction with Speed
model1=lm(Satisfaction.Speed~Download.Speed+Upload.Speed,data=Internet2[,-1])
summary(model1)

# tidying up and mutating model of regression
model1_t = tidy(model1) %>% mutate(model = "Model 1") %>%
   relabel_predictors(Upload.Speed = "Upload",
                     Download.Speed = "Download",
                     Subscribed.Speed = "Subscribed")
```

```{r message= FALSE, warning = FALSE}
# creating second model of regression, this time with Subscribed Speeds 
model2=lm(Satisfaction.Speed~Download.Speed+Upload.Speed+Subscribed.Speed,data=Internet2[,-1]) # ~. means: all the remaining variables
summary(model2)

# tidying up and mutating second model of regression 
model2_t <- tidy(model2) %>% mutate(model = "Model 2") %>%
   relabel_predictors(Upload.Speed = "Upload",
                     Download.Speed = "Download",
                     Subscribed.Speed = "Subscribed")
```

```{r message= FALSE, warning = FALSE}
# combining models 
allModels=rbind(model1_t, model2_t)

#plotting
dwplot(allModels) 
```

```{r message= FALSE, warning = FALSE}
# plotting models and adding/changing theme/text elements 
dwplot(allModels) + 
  geom_vline(xintercept = 0, 
               colour = "green", 
               linetype = 2) + 
  scale_colour_grey(start = .1, end = .7) + 
  labs(y = "Independent Variables",
title = "Relationship Between Speed Satisfaction & 
Download, Upload, and Subscribed Speed", 
         caption = "Source:Stevenson Business and Organization Internet Survey") +
  theme(plot.margin=unit(c(1,1,.5,.5),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0.5)),
                    plot.subtitle = (element_text(hjust = 0.5, vjust = 2)),
                    plot.caption=element_text(size=9, vjust=-2),
                    text=element_text(color='black', size = 11),
                    legend.title = element_blank(),
                    axis.line.y=element_line(color = 'black'),
                    axis.line.x=element_line(color='black'),
                    axis.text=element_text(size=8))
```

```{r message= FALSE, warning = FALSE}
##Heatmap

library(scales)
library(ggplot2)

#loading data
link='https://github.com/marcevl/Team-Assignments/raw/master/Internet2.RData'
load(file=url(link))

#changing download speed to a variable from 0-1
Internet2$Download.Speed.Rescaled <- rescale(Internet2$Download.Speed)

#adding data to data frame
df1 <- Internet2

#removing obervation with outlier
df1 <- df1[-3,]

#removing unnecessary variables from heatmap data frame
df.heatmap <- df1[c(2,6,10,40)]

#removing ISPs without many observations
df.heatmap <- subset(df.heatmap, ISP %in% c("Wave", "CenturyLink", "GorgeNet"))

#plotting heat map
heat1 = ggplot(data = df.heatmap, aes(x = Satisfaction.Speed, y = ISP)) +
  geom_tile(aes(fill = Download.Speed.Rescaled))

heat1
```


```{r message= FALSE, warning = FALSE}
#Adding theme elements
heat1 = heat1 + labs(title='Satisfaction with ISP not correlated with Download Speed',
            y=NULL,
            x='Satisfaction rating',
            caption='Source: Stevenson Business and Organization Internet Survey',
            fill='Range of \nDownload Speeds')

heat2 = heat1 + theme(plot.margin=unit(c(.5,1,1,1),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0,
                                margin=unit(c(0,0,.5,0),'cm'))),
                    plot.subtitle = (element_text(hjust = 0.5, vjust = 2)),
                    plot.caption=element_text(size=8, hjust=2),
                    legend.text=element_blank(),
                    legend.background=element_rect(linetype='solid',
                                                   color='black'),
                    panel.background=element_rect(fill='white'),
                    text=element_text(color='gray25', size = 11),
                    axis.line.y=element_line(color = 'black'),
                    axis.line.x=element_line(color='black'),
                    axis.ticks=element_blank(),
                    axis.text=element_text(size=8))

heat2 + scale_fill_gradient(low='lightblue',high='navy',
                            guide_colorbar(reverse=TRUE,
                                           title='Download Speed'))
```





